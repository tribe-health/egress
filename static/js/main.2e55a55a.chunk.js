(this["webpackJsonplivekit-egress-web"]=this["webpackJsonplivekit-egress-web"]||[]).push([[0],{11:function(t,e,a){t.exports={stage:"SpeakerLayout_stage__25205",stageCenter:"SpeakerLayout_stageCenter__2UqBp",stageSidebar:"SpeakerLayout_stageSidebar__WeIBE"}},30:function(t,e,a){},51:function(t,e,a){},52:function(t,e,a){"use strict";a.r(e);var i=a(0),n=a.n(i),r=a(13),c=a.n(r),s=a(9),o=a.n(s),d=(a(28),a(29),a(30),a(3)),u=a(6),l=a(7),g=a(2),p=a(8),j=a.n(p),h=a(5),f=function(t){var e=t.participants,a=t.room,r=n.a.useState([]),c=Object(u.a)(r,2),s=c[0],o=c[1],g=n.a.useState(j.a.grid1x1),p=Object(u.a)(g,2),f=p[0],b=p[1];return Object(i.useEffect)((function(){var t,i=e.length;1===e.length?b(j.a.grid1x1):2===e.length?b(j.a.grid2x1):e.length<=4?b(j.a.grid2x2):e.length<=9?b(j.a.grid3x3):e.length<=16?b(j.a.grid4x4):(b(j.a.grid5x5),i=Math.min(i,25));var n=[];s.forEach((function(t){((null===a||void 0===a?void 0:a.participants.has(t.sid))||(null===a||void 0===a?void 0:a.localParticipant.sid)===t.sid)&&n.push(t)})),null===a||void 0===a||null===(t=a.activeSpeakers)||void 0===t||t.forEach((function(t){if(!n.includes(t)&&(t===(null===a||void 0===a?void 0:a.localParticipant)||(null===a||void 0===a?void 0:a.participants.has(t.sid)))){var e=n.findIndex((function(t){return!t.isSpeaking}));e>=0?n[e]=t:n.push(t)}}));var r,c=Object(d.a)(e);try{for(c.s();!(r=c.n()).done;){var u=r.value;if(n.length>=i)break;n.includes(u)||u.isSpeaking||n.push(u)}}catch(l){c.e(l)}finally{c.f()}n.length>i&&n.splice(i,n.length-i),o(n)}),[e]),0===s.length?Object(h.jsx)("div",{}):Object(h.jsx)("div",{className:"".concat(j.a.stage," ").concat(f),children:s.map((function(t){return Object(h.jsx)(l.b,{participant:t,orientation:"landscape",width:"100%",height:"100%"},t.identity)}))})},b=a(11),v=a.n(b),x=function(t){var e,a,i,n=t.participants.filter((function(t){return t instanceof g.RemoteParticipant}));return n.forEach((function(t){var a=t.getTrack(g.Track.Source.ScreenShare);a&&a.isSubscribed&&(e=a.videoTrack)})),0===n.length?Object(h.jsx)("div",{}):1!==n.length||e?(e?(a=n,i=Object(h.jsx)(l.c,{track:e,height:"100%",width:"100%"})):(a=n.slice(1),i=Object(h.jsx)(l.b,{participant:n[0],width:"100%",height:"100%",orientation:"landscape"},n[0].identity)),Object(h.jsxs)("div",{className:v.a.stage,children:[Object(h.jsx)("div",{className:v.a.stageCenter,children:i}),Object(h.jsx)("div",{className:v.a.stageSidebar,children:a.map((function(t){return Object(h.jsx)(l.b,{participant:t,width:"100%",height:"100%",orientation:"landscape"},t.identity)}))})]})):Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(l.b,{participant:n[0],width:"100%",height:"100%",orientation:"landscape"})})};function O(t){var e=t.url,a=t.token,n=t.layout,r=Object(i.useState)(n),c=Object(u.a)(r,2),s=c[0],d=c[1],p=Object(l.d)({adaptiveStream:!0}),j=p.room,f=p.participants,b=p.audioTracks;if(Object(i.useEffect)((function(){p.connect(e,a)}),[e]),Object(i.useEffect)((function(){j&&(o.a.setRoom(j,{autoEnd:!0}),o.a.onLayoutChanged((function(t){d(t)})),o.a.startRecording())}),[j]),!e||!a)return Object(h.jsx)("div",{className:"error",children:"missing required params url and token"});if(!j)return Object(h.jsx)("div",{});var v=f.filter((function(t){return t instanceof g.RemoteParticipant}));return Object(h.jsx)(_,{layout:s,room:j,participants:v,audioTracks:b})}function _(t){var e=t.layout,a=t.room,n=t.participants,r=t.audioTracks,c=Object(i.useState)(!1),s=Object(u.a)(c,2),o=s[0],g=s[1];Object(i.useEffect)((function(){var t,e=!1,a=Object(d.a)(n);try{for(a.s();!(t=a.n()).done;){t.value.isScreenShareEnabled&&(e=!0)}}catch(i){a.e(i)}finally{a.f()}g(e)}),[n]);var p="light";"speaker-dark"!==e&&"grid-dark"!==e||(p="dark");var j,b="roomContainer";return p&&(b+=" ".concat(p)),j=e.startsWith("speaker")||o?Object(h.jsx)(x,{room:a,participants:n}):Object(h.jsx)(f,{room:a,participants:n}),Object(h.jsxs)("div",{className:b,children:[j,r.map((function(t){return Object(h.jsx)(l.a,{track:t,isLocal:!1},t.sid)}))]})}var k=function(){return Object(h.jsx)("div",{className:"container",children:Object(h.jsx)(O,{url:o.a.getLiveKitURL(),token:o.a.getAccessToken(),layout:o.a.getLayout()})})};a(51);c.a.render(Object(h.jsx)(k,{}),document.getElementById("root"))},8:function(t,e,a){t.exports={stage:"GridLayout_stage__30DlR",grid1x1:"GridLayout_grid1x1__3aEAn",grid2x1:"GridLayout_grid2x1__2Ba_1",grid2x2:"GridLayout_grid2x2__2f_nY",grid3x3:"GridLayout_grid3x3__170FX",grid4x4:"GridLayout_grid4x4__2G9kX",grid5x5:"GridLayout_grid5x5__Iw6qK"}}},[[52,1,2]]]);
//# sourceMappingURL=main.2e55a55a.chunk.js.map